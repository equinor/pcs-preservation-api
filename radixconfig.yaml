apiVersion: radix.equinor.com/v1
kind: RadixApplication
metadata:
    name: procosys-preservation-api
spec:
    environments:
        - name: dev
          build:
              from: pbi/104952_Move_Preservation_API_to_Radix
#        - name: test
#        - name: prod
    components:
        - name: backend
          identity:
                azure:
                    clientId: 67b2f053-30bf-4ffc-9206-ef57f631efcb
          image: procosys.azurecr.io/preservation/api:{imageTagName}
          privateImageHubs:
            procosys.azurecr.io:
              username: 343069e3-ceaa-4256-bdc8-49fa3646c1c4
              email: arbje@equinor.com
          ports:
              - name: http
                port: 5000
          publicPort: http 
          secrets:
              - CONNECTIONSTRINGS__APPCONFIG
          environmentConfig:
              - environment: dev
                imageTagName: latest
                variables:
                    ASPNETCORE_ENVIRONMENT: 'Development'
                    UseAzureAppConfiguration: 'true'
                monitoring: true
                resources:
                    requests:
                        memory: '128Mi'
                        cpu: '100m'
                    limits:
                        memory: '256Mi'
                        cpu: '250m'
 #             - environment: test
 #               variables:
 #                   SEARCH_ENVIRONMENT_NAME: 'TEST'
 #               replicas: 2
 #               resources:
 #                   requests:
 #                       memory: '128Mi'
 #                       cpu: '100m'
 #                   limits:
 #                       memory: '256Mi'
 #                       cpu: '250m'
 #             - environment: prod
 #               variables:
 #                   SEARCH_ENVIRONMENT_NAME: 'PROD'
 #               replicas: 2
 #               monitoring: true
 #               resources:
 #                   requests:
 #                       memory: '128Mi'
 #                       cpu: '100m'
 #                   limits:
 #                       memory: '256Mi'
 #                       cpu: '250m'
